{
  "model_name": "microsoft/deberta-v3-base",
  "test_metrics": {
    "loss": 0.1696685545448813,
    "tool_loss": 0.012019420260975761,
    "ner_loss": 0.006291488749975147,
    "tool_f1": 0.9962416883492339,
    "tool_precision": 0.9962416883492339,
    "tool_recall": 0.9962416883492339,
    "tool_exact_match": 0.995239714382863,
    "character_intent_acc": 0.9792207792207792,
    "session_intent_acc": 0.9473684210526315,
    "rulebook_intent_acc": 0.9957364341085271,
    "avg_intent_acc": 0.9741085447939793,
    "ner_f1": 0.9899313501144164,
    "character_intent_loss": 0.1484848686880545,
    "session_intent_loss": 0.29124533398830216,
    "rulebook_intent_loss": 0.01747058958380876
  },
  "training_history": [
    {
      "epoch": 1,
      "stage": "stage1",
      "train_loss": 0.46625277729016606,
      "val_loss": 0.03642724412898331,
      "val_tool_f1": 0.9953917050691244,
      "val_tool_exact_match": 0.9938775510204082,
      "val_ner_f1": 0.9386999768679157,
      "val_avg_intent_acc": 0.0,
      "stage_score": 0.9670458409685201
    },
    {
      "epoch": 2,
      "stage": "stage1",
      "train_loss": 0.02474726924607318,
      "val_loss": 0.02030878494311448,
      "val_tool_f1": 0.9958255362026774,
      "val_tool_exact_match": 0.9945578231292517,
      "val_ner_f1": 0.982496545370797,
      "val_avg_intent_acc": 0.0,
      "stage_score": 0.9891610407867373
    },
    {
      "epoch": 3,
      "stage": "stage1",
      "train_loss": 0.0113017822858756,
      "val_loss": 0.015980814787010033,
      "val_tool_f1": 0.9964013243126529,
      "val_tool_exact_match": 0.995578231292517,
      "val_ner_f1": 0.9833795013850415,
      "val_avg_intent_acc": 0.0,
      "stage_score": 0.9898904128488473
    },
    {
      "epoch": 4,
      "stage": "stage2",
      "train_loss": 1.4092148938418732,
      "val_loss": 0.3197356266900897,
      "val_tool_f1": 0.9939498703543648,
      "val_tool_exact_match": 0.9884353741496599,
      "val_ner_f1": 0.9795261099608926,
      "val_avg_intent_acc": 0.9197261309215768,
      "val_character_intent_acc": 0.9377880184331797,
      "val_session_intent_acc": 0.8941176470588236,
      "val_rulebook_intent_acc": 0.9272727272727272,
      "stage_score": 0.9644007037456115
    },
    {
      "epoch": 5,
      "stage": "stage2",
      "train_loss": 0.22950499715744113,
      "val_loss": 0.17492393334396183,
      "val_tool_f1": 0.9953890489913545,
      "val_tool_exact_match": 0.9928571428571429,
      "val_ner_f1": 0.9847856154910097,
      "val_avg_intent_acc": 0.9568869002826598,
      "val_character_intent_acc": 0.9723502304147466,
      "val_session_intent_acc": 0.9137254901960784,
      "val_rulebook_intent_acc": 0.9845849802371541,
      "stage_score": 0.9790205215883413
    },
    {
      "epoch": 6,
      "stage": "stage2",
      "train_loss": 0.1161185801171561,
      "val_loss": 0.13558042432629483,
      "val_tool_f1": 0.9953917050691244,
      "val_tool_exact_match": 0.9931972789115646,
      "val_ner_f1": 0.9870490286771509,
      "val_avg_intent_acc": 0.9703643861386623,
      "val_character_intent_acc": 0.9723502304147466,
      "val_session_intent_acc": 0.9490196078431372,
      "val_rulebook_intent_acc": 0.9897233201581027,
      "stage_score": 0.9842683732949792
    },
    {
      "epoch": 7,
      "stage": "stage2",
      "train_loss": 0.07010185641996466,
      "val_loss": 0.13381996261191292,
      "val_tool_f1": 0.9959712230215827,
      "val_tool_exact_match": 0.9938775510204082,
      "val_ner_f1": 0.9875403784033225,
      "val_avg_intent_acc": 0.9733567242188643,
      "val_character_intent_acc": 0.9746543778801844,
      "val_session_intent_acc": 0.9549019607843138,
      "val_rulebook_intent_acc": 0.9905138339920949,
      "stage_score": 0.98562277521459
    },
    {
      "epoch": 8,
      "stage": "stage2",
      "train_loss": 0.039192197659244615,
      "val_loss": 0.12244090976072704,
      "val_tool_f1": 0.9958243340532758,
      "val_tool_exact_match": 0.9935374149659864,
      "val_ner_f1": 0.9911955514365153,
      "val_avg_intent_acc": 0.9775590953794072,
      "val_character_intent_acc": 0.9723502304147466,
      "val_session_intent_acc": 0.9686274509803922,
      "val_rulebook_intent_acc": 0.991699604743083,
      "stage_score": 0.9881929936230661
    },
    {
      "epoch": 9,
      "stage": "stage2",
      "train_loss": 0.025043994280128136,
      "val_loss": 0.12914146963711295,
      "val_tool_f1": 0.995826737660095,
      "val_tool_exact_match": 0.9942176870748299,
      "val_ner_f1": 0.9907407407407407,
      "val_avg_intent_acc": 0.9778225999907381,
      "val_character_intent_acc": 0.9723502304147466,
      "val_session_intent_acc": 0.9686274509803922,
      "val_rulebook_intent_acc": 0.9924901185770751,
      "stage_score": 0.9881300261305247
    },
    {
      "epoch": 10,
      "stage": "stage2",
      "train_loss": 0.015520943749557457,
      "val_loss": 0.1118804546768724,
      "val_tool_f1": 0.9962568384681831,
      "val_tool_exact_match": 0.9948979591836735,
      "val_ner_f1": 0.9909826589595376,
      "val_avg_intent_acc": 0.9800295909940329,
      "val_character_intent_acc": 0.9746543778801844,
      "val_session_intent_acc": 0.9725490196078431,
      "val_rulebook_intent_acc": 0.9928853754940712,
      "stage_score": 0.9890896961405845
    },
    {
      "epoch": 11,
      "stage": "finetune",
      "train_loss": 0.015347471555050224,
      "val_loss": 0.11514645962558026,
      "val_tool_f1": 0.9962557603686636,
      "val_tool_exact_match": 0.9945578231292517,
      "val_ner_f1": 0.9905202312138728,
      "val_avg_intent_acc": 0.9796170361552755,
      "val_character_intent_acc": 0.9769585253456221,
      "val_session_intent_acc": 0.9705882352941176,
      "val_rulebook_intent_acc": 0.991304347826087,
      "stage_score": 0.9887976759126039
    },
    {
      "epoch": 12,
      "stage": "finetune",
      "train_loss": 0.013515813690248804,
      "val_loss": 0.11297844244282991,
      "val_tool_f1": 0.9962557603686636,
      "val_tool_exact_match": 0.9945578231292517,
      "val_ner_f1": 0.9905070618198656,
      "val_avg_intent_acc": 0.980912094533083,
      "val_character_intent_acc": 0.9792626728110599,
      "val_session_intent_acc": 0.9705882352941176,
      "val_rulebook_intent_acc": 0.9928853754940712,
      "stage_score": 0.9892249722405374
    },
    {
      "epoch": 13,
      "stage": "finetune",
      "train_loss": 0.011257281926225954,
      "val_loss": 0.1099801666262109,
      "val_tool_f1": 0.9965457685664939,
      "val_tool_exact_match": 0.9952380952380953,
      "val_ner_f1": 0.991207774178621,
      "val_avg_intent_acc": 0.9798978386883676,
      "val_character_intent_acc": 0.9746543778801844,
      "val_session_intent_acc": 0.9725490196078431,
      "val_rulebook_intent_acc": 0.9924901185770751,
      "stage_score": 0.9892171271444942
    },
    {
      "epoch": 14,
      "stage": "finetune",
      "train_loss": 0.011797852918216055,
      "val_loss": 0.11066942887938912,
      "val_tool_f1": 0.9965447739706306,
      "val_tool_exact_match": 0.9952380952380953,
      "val_ner_f1": 0.9902777777777777,
      "val_avg_intent_acc": 0.9800122930722717,
      "val_character_intent_acc": 0.9769585253456221,
      "val_session_intent_acc": 0.9705882352941176,
      "val_rulebook_intent_acc": 0.9924901185770751,
      "stage_score": 0.98894494827356
    },
    {
      "epoch": 15,
      "stage": "finetune",
      "train_loss": 0.00945029080289912,
      "val_loss": 0.11002835854022756,
      "val_tool_f1": 0.9965447739706306,
      "val_tool_exact_match": 0.9952380952380953,
      "val_ner_f1": 0.9902777777777777,
      "val_avg_intent_acc": 0.9815656893043249,
      "val_character_intent_acc": 0.9792626728110599,
      "val_session_intent_acc": 0.9725490196078431,
      "val_rulebook_intent_acc": 0.9928853754940712,
      "stage_score": 0.9894627470175777
    }
  ],
  "best_combined_score": 0.9894627470175777,
  "config": {
    "model_name": "microsoft/deberta-v3-base",
    "batch_size": 32,
    "learning_rate": 2e-05,
    "head_learning_rate": 0.0001,
    "max_length": 128,
    "weight_decay": 0.01,
    "gradient_accumulation_steps": 1,
    "stage1_epochs": 3,
    "stage2_epochs": 7,
    "finetune_epochs": 5,
    "warmup_ratio": 0.1,
    "tool_loss_weight": 1.0,
    "intent_loss_weight": 1.0,
    "ner_loss_weight": 1.0,
    "patience": 3,
    "classifier_dropout": 0.1
  }
}